<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Configuration and device identification on network gateways</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html --> 
<meta name="src" content="conf_id_gateways_kers-final.tex"> 
<meta name="date" content="2013-05-30 14:33:00"> 
<link rel="stylesheet" type="text/css" href="conf_id_gateways_kers-final.css"> 
</head><body 
>
                                                                           

                                                                           
<!--l. 63--><p class="indent" >
                                                                           

                                                                           
   <div class="maketitle"> <span 
class="ec-lmssbx-10x-x-172">Configuration and device identification on</span>
 <span 
class="ec-lmssbx-10x-x-172">network gateways</span>
 <span 
class="ec-lmss-10x-x-109">Konfigurering och enhetsidentifiering på n</span><span 
class="ec-lmss-10x-x-109">ätverksgateways</span>
 <span 
class="ec-lmss-12">SIMON KERS</span>
<span 
class="ec-lmss-10x-x-109">Bachelor&#8217;s Thesis at KTH</span><br />
<span 
class="ec-lmss-10x-x-109">School of Technology and Health</span><br />
<span 
class="ec-lmss-10x-x-109">Supervisor: Micael Lundvall</span><br />
<span 
class="ec-lmss-10x-x-109">Examiner: Ibrahim Orhan</span>
   <div  
class="centerline">                                         <span 
class="ec-lmss-10x-x-109">TRITA-STH 2013:22</span>                                         </div>
                                                                           

                                                                           
                                                                           

                                                                           
   </div>
<div class="center" 
>
<!--l. 71--><p class="noindent" >
<!--l. 71--><p class="noindent" ><span 
class="ec-lmssdc-10x-x-207">Abstract</span></div>
           <span 
class="ec-lmr-10">To  set  up  port  forwarding  rules  on  network  gateways,  certain</span>
        <span 
class="ec-lmr-10">technical skills are required from end-users. These assumptions in the</span>
        <span 
class="ec-lmr-10">gateway  software  stack,  can  lead  to  an  increase  in  support  calls  to</span>
        <span 
class="ec-lmr-10">the network operators and resellers of equipment. The design in itself</span>
        <span 
class="ec-lmr-10">is also an important part of the product and a complicated interface</span>
        <span 
class="ec-lmr-10">will  contribute  to  a  lessened  user  experience.  Other  risks  with  an</span>
        <span 
class="ec-lmr-10">overwhelming user interface include faulty configuration, leaving the</span>
        <span 
class="ec-lmr-10">network vulnerable to attacks.</span>
        <!--l. 81--><p class="indent" >     <span 
class="ec-lmr-10">We present an enhancement of the current port forwarding settings,</span>
        <span 
class="ec-lmr-10">with  an  extensible  library  of  presets.  To  help  users  with  detecting</span>
        <span 
class="ec-lmr-10">available services, a wrapper for a network scanner was implemented, to</span>
        <span 
class="ec-lmr-10">detect devices and services on the local network. These parts combined</span>
        <span 
class="ec-lmr-10">relieves end-users of looking up forwarding rules for ports and protocols</span>
        <span 
class="ec-lmr-10">to configure their gateway, basing their decisions on data collected by</span>
        <span 
class="ec-lmr-10">the network scanner or by using an applications name instead of its</span>
        <span 
class="ec-lmr-10">ports.</span>
        <!--l. 86--><p class="indent" >     <span 
class="ec-lmr-10">Using  the  Nmap  utility  for  identifying  services  on  the  network,</span>
        <span 
class="ec-lmr-10">could be considered harmful activity by network admins and intrusion</span>
        <span 
class="ec-lmr-10">detection systems. The preset library is extensible and generic enough</span>
        <span 
class="ec-lmr-10">to be included in the default software suite shipping with the network</span>
        <span 
class="ec-lmr-10">equipment. Working within the centralized configuration system within</span>
        <span 
class="ec-lmr-10">OpenWrt,  the  preset  design  will  add  value  and  allow  resellers  to</span>
        <span 
class="ec-lmr-10">customize  its  services.  This  proposal  could  reduce  support  costs  for</span>
        <span 
class="ec-lmr-10">the service operators and improve user experience and configuration of</span>
        <span 
class="ec-lmr-10">network gateways.</span>
<!--l. 92--><p class="noindent" >
                                                                           

                                                                           
<!--l. 93--><p class="indent" >
                                                                           

                                                                           
<div class="center" 
>
<!--l. 96--><p class="noindent" >
<!--l. 96--><p class="noindent" ><span 
class="ec-lmssdc-10x-x-207">Referat</span></div>
        <div class="center" 
>
<!--l. 96--><p class="noindent" >
<!--l. 96--><p class="noindent" ><span 
class="ec-lmssdc-10x-x-144">Konfigurering och enhetsidentifiering på n</span><span 
class="ec-lmssdc-10x-x-144">ätverksgateways</span></div>
     <!--l. 97--><p class="noindent" ><span 
class="ec-lmr-10">Vid vidarebefodring av portar i n</span><span 
class="ec-lmr-10">ätverksgateways, kr</span><span 
class="ec-lmr-10">ävs ibland vissa tekniska</span>
        <span 
class="ec-lmr-10">f</span><span 
class="ec-lmr-10">örkunskaper av anv</span><span 
class="ec-lmr-10">ändaren. De h</span><span 
class="ec-lmr-10">öga kraven på kunskapsnivå</span>
        <span 
class="ec-lmr-10">kan bidra till ett </span><span 
class="ec-lmr-10">ökat antal supportsamtal f</span><span 
class="ec-lmr-10">ör återf</span><span 
class="ec-lmr-10">örs</span><span 
class="ec-lmr-10">äljare och</span>
        <span 
class="ec-lmr-10">n</span><span 
class="ec-lmr-10">ätverksoperat</span><span 
class="ec-lmr-10">örer. Anv</span><span 
class="ec-lmr-10">ändargr</span><span 
class="ec-lmr-10">änssnittet i sig </span><span 
class="ec-lmr-10">är också en viktig del</span>
        <span 
class="ec-lmr-10">i produkten och ett komplicerat gr</span><span 
class="ec-lmr-10">änssnitt bidrar till f</span><span 
class="ec-lmr-10">örs</span><span 
class="ec-lmr-10">ämrad</span>
        <span 
class="ec-lmr-10">anv</span><span 
class="ec-lmr-10">ändarupplevelse. </span><span 
class="ec-lmr-10">Övriga problem med komplicerade anv</span><span 
class="ec-lmr-10">ändargr</span><span 
class="ec-lmr-10">änssnitt </span><span 
class="ec-lmr-10">är</span>
        <span 
class="ec-lmr-10">risken f</span><span 
class="ec-lmr-10">ör felaktig konfiguration, vilket kan uts</span><span 
class="ec-lmr-10">ätta n</span><span 
class="ec-lmr-10">ätverket f</span><span 
class="ec-lmr-10">ör</span>
        <span 
class="ec-lmr-10">attacker.</span>
        <!--l. 104--><p class="indent" >     <span 
class="ec-lmr-10">En f</span><span 
class="ec-lmr-10">örb</span><span 
class="ec-lmr-10">ättring av nuvarande </span><span 
class="ec-lmri-10">port forwarding</span><span 
class="ec-lmr-10">-inst</span><span 
class="ec-lmr-10">ällningar presenteras,</span>
        <span 
class="ec-lmr-10">tillsammans med ett utbyggbart bibliotek med f</span><span 
class="ec-lmr-10">örinst</span><span 
class="ec-lmr-10">ällda regler. F</span><span 
class="ec-lmr-10">ör att</span>
        <span 
class="ec-lmr-10">hj</span><span 
class="ec-lmr-10">älpa anv</span><span 
class="ec-lmr-10">ändare att identifiera enheter och s</span><span 
class="ec-lmr-10">ätta r</span><span 
class="ec-lmr-10">ätt inst</span><span 
class="ec-lmr-10">ällningar,</span>
        <span 
class="ec-lmr-10">utvecklades en wrapper f</span><span 
class="ec-lmr-10">ör en portskanner, vilken kan identifiera enheter och</span>
        <span 
class="ec-lmr-10">n</span><span 
class="ec-lmr-10">ättj</span><span 
class="ec-lmr-10">änster i den lokala n</span><span 
class="ec-lmr-10">ätverket. Tillsammans underl</span><span 
class="ec-lmr-10">ättar dessa</span>
        <span 
class="ec-lmr-10">delar f</span><span 
class="ec-lmr-10">ör slutanv</span><span 
class="ec-lmr-10">ändare, befriar dem från att referera till regler</span>
        <span 
class="ec-lmr-10">f</span><span 
class="ec-lmr-10">ör portar och protokoll och m</span><span 
class="ec-lmr-10">öjligg</span><span 
class="ec-lmr-10">ör inst</span><span 
class="ec-lmr-10">ällning enbart genom</span>
        <span 
class="ec-lmr-10">att anv</span><span 
class="ec-lmr-10">ända portskanning eller v</span><span 
class="ec-lmr-10">älja namnet på tj</span><span 
class="ec-lmr-10">änsten från en</span>
        <span 
class="ec-lmr-10">lista.</span>
        <!--l. 111--><p class="indent" >     <span 
class="ec-lmr-10">Anv</span><span 
class="ec-lmr-10">ändandet av verktyget Nmap f</span><span 
class="ec-lmr-10">ör att identifiera n</span><span 
class="ec-lmr-10">ättj</span><span 
class="ec-lmr-10">änster på n</span><span 
class="ec-lmr-10">ätverket</span>
        <span 
class="ec-lmr-10">kan m</span><span 
class="ec-lmr-10">öjligtvis betraktas som dataintrång av n</span><span 
class="ec-lmr-10">ätverksadministrat</span><span 
class="ec-lmr-10">örer och</span>
        <span 
class="ec-lmr-10">intrångdetekteringssystem. Databasen med f</span><span 
class="ec-lmr-10">örinst</span><span 
class="ec-lmr-10">ällningar </span><span 
class="ec-lmr-10">är utbyggbar,</span>
        <span 
class="ec-lmr-10">fungerar och passar in tillr</span><span 
class="ec-lmr-10">äckligt bra f</span><span 
class="ec-lmr-10">ör att innefattas i standardmjukvaran.</span>
        <span 
class="ec-lmr-10">Via det centraliserade konfigurationssystemet i OpenWrt, kommer</span>
        <span 
class="ec-lmr-10">utformningen av systemet med f</span><span 
class="ec-lmr-10">örinst</span><span 
class="ec-lmr-10">ällningar f</span><span 
class="ec-lmr-10">ör port forwarding m</span><span 
class="ec-lmr-10">öjligg</span><span 
class="ec-lmr-10">öra</span>
        <span 
class="ec-lmr-10">f</span><span 
class="ec-lmr-10">ör komplementering av n</span><span 
class="ec-lmr-10">ättj</span><span 
class="ec-lmr-10">änster och enheter från återf</span><span 
class="ec-lmr-10">örs</span><span 
class="ec-lmr-10">äljare.</span>
        <span 
class="ec-lmr-10">Systemet kan minska supportkostnader f</span><span 
class="ec-lmr-10">ör bredbandsleverant</span><span 
class="ec-lmr-10">örer och</span>
        <span 
class="ec-lmr-10">bidra till en f</span><span 
class="ec-lmr-10">örb</span><span 
class="ec-lmr-10">ättrad anv</span><span 
class="ec-lmr-10">ändarupplevelse vid konfiguration av</span>
        <span 
class="ec-lmr-10">n</span><span 
class="ec-lmr-10">ätverksgateways.</span>
        <!--l. 121--><p class="indent" >
                                                                           

                                                                           
        <!--l. 122--><p class="indent" >
                                                                           

                                                                           
                                                                           

                                                                           
<!--l. 126--><p class="indent" >
                                                                           

                                                                           
   <h2 class="likechapterHead"><a 
 id="x1-1000"></a>Contents</h2> <div class="tableofcontents">
   <span class="chapterToc" ><a 
href="#x1-20001" id="QQ2-1-2"></a></span>
<br />   <span class="chapterToc" ><a 
href="#x1-30002" id="QQ2-1-3"></a></span>
<br />   &#x00A0;<span class="sectionToc" >2.1 <a 
href="#x1-40002.1" id="QQ2-1-4">Software suite</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >2.1.1 <a 
href="#x1-50002.1.1" id="QQ2-1-5">OpenWrt</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >2.1.2 <a 
href="#x1-60002.1.2" id="QQ2-1-6">OPKG</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >2.1.3 <a 
href="#x1-70002.1.3" id="QQ2-1-7">Inteno Open Platform System</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >2.1.4 <a 
href="#x1-80002.1.4" id="QQ2-1-8">Lua Configuration Interface</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >2.1.5 <a 
href="#x1-90002.1.5" id="QQ2-1-9">Model-View Controller</a></span>
<br />   <span class="chapterToc" ><a 
href="#x1-100003" id="QQ2-1-10"></a></span>
<br />   &#x00A0;<span class="sectionToc" >3.1 <a 
href="#x1-110003.1" id="QQ2-1-11">User experience</a></span>
<br />   &#x00A0;<span class="sectionToc" >3.2 <a 
href="#x1-120003.2" id="QQ2-1-12">Customer support</a></span>
<br />   <span class="chapterToc" ><a 
href="#x1-130004" id="QQ2-1-13"></a></span>
<br />   &#x00A0;<span class="sectionToc" >4.1 <a 
href="#x1-140004.1" id="QQ2-1-15">User interface</a></span>
<br />   <span class="chapterToc" ><a 
href="#x1-150005" id="QQ2-1-16"></a></span>
<br />   &#x00A0;<span class="sectionToc" >5.1 <a 
href="#x1-160005.1" id="QQ2-1-17">Nmap</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >5.1.1 <a 
href="#x1-170005.1.1" id="QQ2-1-18">Wrapper</a></span>
<br />   &#x00A0;<span class="sectionToc" >5.2 <a 
href="#x1-180005.2" id="QQ2-1-19">Preset library</a></span>
<br />   <span class="chapterToc" ><a 
href="#x1-190006" id="QQ2-1-20"></a></span>
<br />   &#x00A0;<span class="sectionToc" >6.1 <a 
href="#x1-200006.1" id="QQ2-1-22">Operating system scan</a></span>
<br />   &#x00A0;<span class="sectionToc" >6.2 <a 
href="#x1-210006.2" id="QQ2-1-24">Version scan</a></span>
<br />   <span class="chapterToc" ><a 
href="#x1-220007" id="QQ2-1-26"></a></span>
<br />   &#x00A0;<span class="sectionToc" >7.1 <a 
href="#x1-230007.1" id="QQ2-1-27">Further development</a></span>
<br />   <span class="chapterToc" ><a 
href="#Q1-1-28">Appendices</a></span>
<br />   <span class="appendixToc" >A <a 
href="#x1-24000A" id="QQ2-1-29"></a></span>
<br />   <span class="chapterToc" ><a 
href="#Q1-1-33">Bibliography</a></span>
   </div>*
                                                                           

                                                                           
                                                                           

                                                                           
                                                                           

                                                                           
<!--l. 129--><p class="indent" >
                                                                           

                                                                           
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;1</span><br /><a 
 id="x1-20001"></a>Introduction</h2> Inteno Broadband Technology is a company that
supplies <span 
class="ec-lmri-10x-x-109">customer premises equipment </span>(CPE) for internet service providers. Their
headquarters and research and development center is located in Stockholm,
Sweden. Inteno Open Systems Platform, or <span 
class="ec-lmri-10x-x-109">iopsys </span>is a GNU/Linux-based open
source platform running on customer premises equipment. It is based on the
OpenWrt distribution which targets embedded devices, specifically network
gateways.<span class="cite">[<a 
href="#XInteno">2</a>]</span>
<!--l. 137--><p class="noindent" >The technical support departments of partners and resellers of Inteno CPE, are looking
to reduce support costs and improve customer experience. Support issues creates costs for
the business and by reducing the number of support tickets and their processing time,
these costs can be reduced.
<!--l. 141--><p class="indent" >   By simplifying configuration through abstracting common tasks for the end-user, the
number of support calls can be reduced. Using automatic device identification and
automating common tasks such as port forwarding, support costs can be reduced and
end-user satisfaction improved. Many common support issues could be automated
by the software running on the CPE and by effective communication with the
end-user through the user interface. One such feature is automatic service discovery
on the local network. The system identifies the ports and services running on
the network devices, that the end-user might want to set up forwarding rules
for.
<!--l. 148--><p class="indent" >   By building a extensible library of presets for common port forwarding rules and
developing a simple selection dialog, the end user can more efficiently set up port
forwarding rules and configure their gateway. The system for service identification is a
wrapper around <span 
class="ec-lmri-10x-x-109">Nmap</span>, that performs a scan of the network nodes and returns a list of
available services. This information is in turn used to match against known presets and
protocols, and offer the user a choice of applying the preset rules for the newly detected
network device. The preset system is extensible, allowing retailers to add their own
devices and services as preset definitions, each with their specific forwarding
rules.
                                                                           

                                                                           
<!--l. 156--><p class="indent" >
                                                                           

                                                                           
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;2</span><br /><a 
 id="x1-30002"></a>Background</h2>
<!--l. 158--><p class="noindent" >The research and development department at Inteno works on improving
the platform, adding value to the end users, the operators and the larger
OpenWrt software project. Because of the nature of OpenWrt&#8217;s free software
licence<span class="footnote-mark"><a 
href="conf_id_gateways_kers-final2.html#fn1x3"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-3001f1"></a> ,
the code is publicly released and available for download from Intenos webpage<span class="cite">[<a 
href="#Xinteno_gpl">1</a>]</span>.
<!--l. 161--><p class="indent" >   There are simple ways in which to improve the user experience, developers of network
gateway software often implement a set of presets of port forwarding rules for common
applications. The interface presents the user with a list of applications in plain text
and lets the user select an IP address, for which the forwarding rules should
apply.
<!--l. 165--><p class="indent" >   Alternative solutions to simplifying port forwarding include using standalone
applications which run on a PC, connected to the local network. These applications has
internal lists of port forwarding rules for common applications and devices, which is then
applied for a specific IP address on the local network. <span class="cite">[<a 
href="#Xportforward.com">5</a>]</span>
<!--l. 172--><p class="indent" >   To test the newly applied configurations, web-based or locally run port scanners can
be used. They will scan the users external IP address for open ports and present which
are open, this does not guarantee that the packets are routed to the correct internal
address.
   <h3 class="sectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-40002.1"></a>Software suite</h3>
<!--l. 177--><p class="noindent" >The newer Inteno devices ship with the OpenWrt distribution, which is a small
GNU/Linux operating system. It provides the developer with the basic UNIX debugging
tools and a POSIX compatible command-line interface shell.
<!--l. 180--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">2.1.1   </span> <a 
 id="x1-50002.1.1"></a>OpenWrt</h4>
<!--l. 181--><p class="noindent" >OpenWrt is a free and open-source GNU/Linux distribution, targeting embedded
devices, specifically wireless routers, but can run on almost any set of hardware.
Cross-compilation is enabled by OpenWrt Buildroot, which compiles the C code using
uClibc, a lightweight C library focusing on embedded Linux systems. It intends to be a
meta distribution and offers developers a framework on which to base their firmware
on.
<!--l. 185--><p class="indent" >   OpenWrt is generally compiled and linked using gcc and binutils, with the
help of Makefiles and patches for the various gcc versions and target platforms.
Allowing end users as well as service operators and hardware manufacturers
to compile the firmware. It offers the BusyBox set of barebones UNIX tools,
                                                                           

                                                                           
enabling advanced users to fully interact with their Linux system and providing
developers with a familiar platform for debugging and testing their product.
<span class="cite">[<a 
href="#XOpenWrt:structure_design">3</a>]</span>
<!--l. 190--><p class="indent" >   <span 
class="ec-lmri-10x-x-109">Unified Configuration Interface</span>, or UCI, is used in OpenWrt as a uniform format for
commonly used configuration files. UCI has a Lua bindings as well as a command line
interface, to read and modify the configuration files. Rules for port forwarding are defined
in the UCI compatible configuration file in:
                                                                           

                                                                           
   <div class="verbatim" id="verbatim-1">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;/etc/config/firewall
</div>
<!--l. 195--><p class="nopar" >
<!--l. 197--><p class="indent" >   A port forwarding rule which forwards external HTTP traffic over port 80 to the
internal IP 192.168.1.214, is shown in figure <a 
href="#x1-24001A.1">A.1<!--tex4ht:ref: fig:redirect_conf --></a> in appendix <a 
href="#x1-24000A">A<!--tex4ht:ref: appA --></a>. The line <span 
class="ec-lmri-10x-x-109">config redirect</span>
defines the start of a section, a section contains several values and a UCI configuration
file can have several such sections.
<!--l. 200--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">2.1.2   </span> <a 
 id="x1-60002.1.2"></a>OPKG</h4>
<!--l. 201--><p class="noindent" >The package management system used in OpenWrt is Open PacKaGe Management, or
<span 
class="ec-lmri-10x-x-109">OPKG</span>. It is based off the discontinued <span 
class="ec-lmri-10x-x-109">ipkg </span>and operates similar to <span 
class="ec-lmri-10x-x-109">APT </span>and <span 
class="ec-lmri-10x-x-109">dpkg </span>of
Debian-based distributions. It targets GNU/Linux based operating systems for
embedded devices and there are currently over 2000 OPKG packages available for
OpenWrt.
<!--l. 204--><p class="indent" >   The OpenWrt system and its packages are built using <span 
class="ec-lmri-10x-x-109">GNU Autoconf</span>, which
automates tasks associated with compiling larger software suites. This includes pulling in
parts of the system from remote software repositories and automatically resolving
dependencies on programs and libraries.
<!--l. 207--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">2.1.3   </span> <a 
 id="x1-70002.1.3"></a>Inteno Open Platform System</h4>
<!--l. 208--><p class="noindent" >For Customer Premises Equipment like wireless gateways, Inteno Open Platform System
offers an open-source Linux distribution based on OpenWrt. It uses the OpenWrt build
system including cross-compilation toolchain to ensure compatibility with the ecosystem
and upstream.
<!--l. 211--><p class="indent" >   Inteno maintains and hosts a remote repository, which contains a frozen
release of OpenWrt and compatible packages and patches. This ensures good
compatibility with Inteno hardware and protection from breakage because of upstream
code<span class="footnote-mark"><a 
href="conf_id_gateways_kers-final3.html#fn2x3"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-7001f2"></a> .
   <h4 class="subsectionHead"><span class="titlemark">2.1.4   </span> <a 
 id="x1-80002.1.4"></a>Lua Configuration Interface</h4>
                                                                           

                                                                           
<!--l. 215--><p class="noindent" >Lua Configuration Interface, or <span 
class="ec-lmri-10x-x-109">LuCI</span>, is a suite of programs and libraries for extending
OpenWrt using the Lua programming language and providing a web interface built with
the Model-View Controller architecture. It originated in the OpenWrt project, but is now
an independent project on its own.
<!--l. 219--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">2.1.5   </span> <a 
 id="x1-90002.1.5"></a>Model-View Controller</h4>
<!--l. 220--><p class="noindent" >LuCI relies on the <span 
class="ec-lmri-10x-x-109">Model-View Controller </span>software architecture pattern and separates
data and its visual representation. It is divides in three parts with the model representing
the data and storing in in UCI configuration files.
                                                                           

                                                                           
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;3</span><br /><a 
 id="x1-100003"></a>Problem</h2>
   <h3 class="sectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-110003.1"></a>User experience</h3>
<!--l. 225--><p class="noindent" >End users of Inteno CPE have expressed concern about the relative difficulty of port
forwarding and configuration of their network gateway. The default settings page for port
forwarding is currently located under the <span 
class="ec-lmri-10x-x-109">Firewall </span>tab in the OpenWrt front end, the
forwarding procedure involves looking up ports for the specific device or unit, and
entering these on the web page forms.
<!--l. 228--><p class="indent" >   These set of rules sometimes involve several ports and protocols, increasing the
possibility for misstep and faulty configuration by the end user. If we could reduce the
complexities of this common task of address translation and present it in an way that are
easily understandable, then customer satisfaction would increase. Such tasks could be
well suited for automation by software, especially for applications and devices which
require several port forwarding rules, automating some of these steps will save time and
bring overall value to the user experience.
<!--l. 233--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-120003.2"></a>Customer support</h3>
<!--l. 234--><p class="noindent" >Connectivity of the XBox 360 gaming console has been a common issue and the device is
common among end users, this was also chosen as reference device to do tests and
verifications against. One of the most commonly reported issues of end users, is
setting up port forwarding for connecting their XBox 360 to the XBox Live
network.
                                                                           

                                                                           
<!--l. 237--><p class="indent" >
                                                                           

                                                                           
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;4</span><br /><a 
 id="x1-130004"></a>Design</h2>
<!--l. 239--><p class="noindent" >The overall design of the system consists of two parts, the service identification and port
forwarding presets. These parts are connected through the underlying software and
presented on the user interface.
<!--l. 242--><p class="indent" >   As shown in figure&#x00A0;<a 
href="#x1-130014.1">4.1<!--tex4ht:ref: fig:wizard-seq_dia --></a>, the communication between the parts of the port forwarding
process is outlined. The user initiates the identification procedure and the identification
process starts. When the results from the identification are returned the list of presets is
sorted, based on identification and the user can review their options. By selecting the
name of the service, the correct forwarding rules are loaded and presented to the user,
who can then chose to apply them, after which they are written to the configuration files.
<hr class="figure"><div class="figure" 
>
                                                                           

                                                                           
<a 
 id="x1-130011"></a>
                                                                           

                                                                           
<!--l. 248--><p class="noindent" ><img 
src="conf_id_gateways_kers-final0x.png" alt="PIC" class="graphics" width="426.79134pt" height="233.2563pt" ><!--tex4ht:graphics  
name="conf_id_gateways_kers-final0x.png" src="wizard-seq_dia.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;4.1: </span><span  
class="content">Sequential diagram of applying port forwarding rules</span></div><!--tex4ht:label?: x1-130011 -->
                                                                           

                                                                           
<!--l. 251--><p class="indent" >   </div><hr class="endfigure">
   <h3 class="sectionHead"><span class="titlemark">4.1   </span> <a 
 id="x1-140004.1"></a>User interface</h3>
<!--l. 256--><p class="noindent" >For a port forwarding interface page, the user is presented with detected nodes and their
respective network services. Listed presets are sorted by the output from the service
identification process, presenting the user with the most likely services at the top of the
list.
<!--l. 259--><p class="indent" >   To apply the port forwarding rule set, the user selects a node in the network and the
service from the sorted list, then applies it. Instead of performing all the steps
automatically, the user is required to interact and approve of the suggested changes. The
service identification is there to help the users make choices, not deciding for
them.
                                                                           

                                                                           
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;5</span><br /><a 
 id="x1-150005"></a>Implementation</h2> The implementation consists of three general parts that
work together in delivering easier forwarding rules configuration. As shown in figure&#x00A0;<a 
href="#x1-130014.1">4.1<!--tex4ht:ref: fig:wizard-seq_dia --></a>,
the three configuration files that together with user input, are used as sources for the
final redirection rule in the firewall configuration file. The device detection updates the
configuration file <span 
class="ec-lmri-10x-x-109">devices </span>with newly discovered devices, this does not include applications
running on computers or game specific forwarding rules, running on gaming consoles, this
requires user intervention.
   <h3 class="sectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-160005.1"></a>Nmap</h3>
<!--l. 273--><p class="noindent" >The program <span 
class="ec-lmri-10x-x-109">Nmap </span>is a popular network discovery program, and was chosen as the
engine for the service scanner implementation. The XBox 360 gaming console was chosen
at Inteno&#8217;s suggestion, with the motivation that it is one of the devices that end
users have had the most issues with, in regards to port forwarding. Nmap is
capable of detecting several operating systems, embedded devices and network
services.
<!--l. 278--><p class="indent" >   Using Nmap is quite intrusive and could be detected as an attack by intrusion
detection software, used to monitor the network for illicit behavior. An alternative
approach is using passive fingerprinting of network traffic, one such utility if P0f which
uses passive scanning of traffic.<span class="cite">[<a 
href="#Xp0f">4</a>]</span> Inteno routers are configured with cut-through
switching, which effectively hides the packet information from software processing and
analyzing techniques.
<!--l. 282--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">5.1.1   </span> <a 
 id="x1-170005.1.1"></a>Wrapper</h4>
<!--l. 283--><p class="noindent" >Executing the Nmap scanning utility and returning results, is implemented as a shell
script. In the development process of the wrapper, a shell script was written to test
the functionality and extract data about the detected services. The original
thought was to replace this with a Lua script, to make it more cohesive with the
rest of the system. Due to lack of time, the rewrite was cancelled and a quick
adaptation was made to to the script to return valid JSON for the JavaScript
frontend.
<!--l. 292--><p class="indent" >   While testing the service identification features of Nmap, there is no way for Nmap to
positively identify an XBox 360. This failure was due to an inconclusive fingerprint, but
using the flag called version scan &#8211; run with arguments <span 
class="ec-lmri-10x-x-109">-sV </span>&#8211; Nmap interrogates ports
and returns more information than a regular operating system scan. The extra scan using
the Nmap <span 
class="ec-lmri-10x-x-109">version scan</span>, was successfully used to identify the XBox 360. Whenever the
service is identified as <span 
class="ec-lmri-10x-x-109">LSA-or-nterm</span>, the TCP ports 1026 and 1027, were scanned, either
of these are in use by the XBox 360.<span class="cite">[<a 
href="#Xaretheysecure">6</a>]</span> The more thorough version scan is then
matched for <span 
class="ec-lmri-10x-x-109">XBox 360 UPnP</span>, which the wrapper is set to interpret as a positive
match.
                                                                           

                                                                           
<!--l. 299--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-180005.2"></a>Preset library</h3>
<!--l. 300--><p class="noindent" >The preset library consists of common services and port data, that the user
would want to set up forwarding rules for. Details of these ports and protocols
are provided by the application developers, specifically for address translation
reasons.
<!--l. 304--><p class="indent" >   Using the <span 
class="ec-lmri-10x-x-109">Unified Configuration System</span>, that is included in the OpenWrt distribution,
all the basic commands for configuring the firewall rules were prototyped and explored. A
set of <span 
class="ec-lmri-10x-x-109">XBox 360 </span>port forwarding rules from the preset configuration file is shown in figure
<a 
href="#x1-24001A.1">A.1<!--tex4ht:ref: fig:redirect_conf --></a> in appendix <a 
href="#x1-24000A">A<!--tex4ht:ref: appA --></a>.
<!--l. 307--><p class="indent" >   The rules were formatted to fit the UCI configuration file format and
returned as JSON to the JavaScript frontend in an AJAX call through the Lua
dispatcher.<span class="footnote-mark"><a 
href="conf_id_gateways_kers-final4.html#fn1x6"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-18001f1"></a> 
<!--l. 309--><p class="indent" >   Applying the rules requires the user to select the desired service from a list, and
pressing a button which runs a JavaScript function, performing an AJAX call to the Lua
backend, issuing the UCI calls.
                                                                           

                                                                           
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;6</span><br /><a 
 id="x1-190006"></a>Results</h2>
<!--l. 317--><p class="noindent" >Scanning a Raspberry Pi installed with the options <span 
class="ec-lmri-10x-x-109">web server</span>, <span 
class="ec-lmri-10x-x-109">mail server </span>and <span 
class="ec-lmri-10x-x-109">ssh</span>
<span 
class="ec-lmri-10x-x-109">server</span>, detect these services and ports as shown in figure <a 
href="#x1-190006">6<!--tex4ht:ref: fig:rasp_scan --></a>. The mail server option in the
installer, enables identification on ports 110, 143, 993 and 995 because of the various
email delivery protocols.
<!--l. 320--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                           

                                                                           
<a 
 id="x1-190011"></a>
                                                                           

                                                                           
<div class="verbatim" id="verbatim-2">
&#x00A0;&#x00A0;&#x00A0;PORT&#x00A0;&#x00A0;&#x00A0;&#x00A0;STATE&#x00A0;SERVICE&#x00A0;&#x00A0;REASON&#x00A0;&#x00A0;VERSION
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;22/tcp&#x00A0;&#x00A0;open&#x00A0;&#x00A0;ssh&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;syn-ack&#x00A0;OpenSSH&#x00A0;6.0p1&#x00A0;Debian&#x00A0;4&#x00A0;(protocol&#x00A0;2.0)
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;80/tcp&#x00A0;&#x00A0;open&#x00A0;&#x00A0;http&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;syn-ack&#x00A0;Apache&#x00A0;httpd&#x00A0;2.2.22&#x00A0;((Debian))
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;110/tcp&#x00A0;open&#x00A0;&#x00A0;pop3&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;syn-ack&#x00A0;Dovecot&#x00A0;pop3d
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;111/tcp&#x00A0;open&#x00A0;&#x00A0;rpcbind&#x00A0;&#x00A0;syn-ack&#x00A0;2-4&#x00A0;(RPC&#x00A0;#100000)
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;143/tcp&#x00A0;open&#x00A0;&#x00A0;imap&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;syn-ack&#x00A0;Dovecot&#x00A0;imapd
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;993/tcp&#x00A0;open&#x00A0;&#x00A0;ssl/imap&#x00A0;syn-ack&#x00A0;Dovecot&#x00A0;imapd
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;995/tcp&#x00A0;open&#x00A0;&#x00A0;ssl/pop3&#x00A0;syn-ack&#x00A0;Dovecot&#x00A0;pop3d
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;MAC&#x00A0;Address:&#x00A0;B8:27:EB:0C:A5:70&#x00A0;(Raspberry&#x00A0;Pi&#x00A0;Foundation)
</div>
<!--l. 333--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;6.1: </span><span  
class="content"> <span 
class="ec-lmr-10">Nmap version scan of the Raspberry Pi, identifying available services on the</span>
<span 
class="ec-lmr-10">open ports.  </span></span></div><!--tex4ht:label?: x1-190011 -->
                                                                           

                                                                           
<!--l. 339--><p class="indent" >   </div><hr class="endfigure">
<!--l. 340--><p class="indent" >   The front-end with select the first service from the dropdown list of presets and
present the user with the choice to apply its forwarding rules.
<!--l. 342--><p class="indent" >
                                                                           

                                                                           
   <h3 class="sectionHead"><span class="titlemark">6.1   </span> <a 
 id="x1-200006.1"></a>Operating system scan</h3>
<!--l. 344--><p class="noindent" >As shown in figure <a 
href="#x1-200016.2">6.2<!--tex4ht:ref: fig:nmapos --></a>, the scan is unable to identify the correct operating system. The
scan had a duration of 43.74 seconds.
<!--l. 346--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                           

                                                                           
<a 
 id="x1-200012"></a>
                                                                           

                                                                           
<div class="verbatim" id="verbatim-3">
root@Inteno:~#&#x00A0;time&#x00A0;nmap&#x00A0;-O&#x00A0;--osscan-guess&#x00A0;--fuzzy&#x00A0;192.168.1.218
&#x00A0;<br />
&#x00A0;<br />Starting&#x00A0;Nmap&#x00A0;5.51&#x00A0;(&#x00A0;http://nmap.org&#x00A0;)&#x00A0;at&#x00A0;2013-05-28&#x00A0;18:03&#x00A0;CEST
&#x00A0;<br />Nmap&#x00A0;scan&#x00A0;report&#x00A0;for&#x00A0;192.168.1.218
&#x00A0;<br />Host&#x00A0;is&#x00A0;up&#x00A0;(0.00061s&#x00A0;latency).
&#x00A0;<br />Not&#x00A0;shown:&#x00A0;999&#x00A0;filtered&#x00A0;ports
&#x00A0;<br />PORT&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;STATE&#x00A0;SERVICE
&#x00A0;<br />1026/tcp&#x00A0;open&#x00A0;&#x00A0;LSA-or-nterm
&#x00A0;<br />MAC&#x00A0;Address:&#x00A0;00:22:48:40:11:FE&#x00A0;(Microsoft)
&#x00A0;<br />Warning:&#x00A0;OSScan&#x00A0;results&#x00A0;may&#x00A0;be&#x00A0;unreliable&#x00A0;because&#x00A0;we&#x00A0;could&#x00A0;not&#x00A0;find&#x00A0;at&#x00A0;least&#x00A0;1
&#x00A0;<br />open&#x00A0;and&#x00A0;1&#x00A0;closed&#x00A0;port
&#x00A0;<br />Device&#x00A0;type:&#x00A0;general&#x00A0;purpose|switch
&#x00A0;<br />Running&#x00A0;(JUST&#x00A0;GUESSING):&#x00A0;IBM&#x00A0;OS/2&#x00A0;4.X&#x00A0;(92%),&#x00A0;HP&#x00A0;OpenVMS&#x00A0;7.X|8.X&#x00A0;(88%),&#x00A0;HP&#x00A0;embedded
&#x00A0;<br />(87%),&#x00A0;Fujitsu&#x00A0;Siemens&#x00A0;ReliantUNIX&#x00A0;(86%),&#x00A0;Compaq&#x00A0;Tru64&#x00A0;UNIX&#x00A0;5.X&#x00A0;(85%)
&#x00A0;<br />Aggressive&#x00A0;OS&#x00A0;guesses:&#x00A0;IBM&#x00A0;OS/2&#x00A0;Warp&#x00A0;2.0&#x00A0;(92%),&#x00A0;HP&#x00A0;OpenVMS&#x00A0;7.2&#x00A0;(88%),&#x00A0;HP&#x00A0;ProCurve
&#x00A0;<br />2524&#x00A0;switch&#x00A0;(J4813A)&#x00A0;(87%),&#x00A0;HP&#x00A0;ProCurve&#x00A0;4104gl&#x00A0;or&#x00A0;4108gl&#x00A0;switch&#x00A0;(87%),&#x00A0;Fujitsu
&#x00A0;<br />Siemens&#x00A0;ReliantUNIX-N&#x00A0;(SINIX-N)&#x00A0;on&#x00A0;RM400&#x00A0;(86%),&#x00A0;Compaq&#x00A0;Tru64&#x00A0;UNIX&#x00A0;5.1B&#x00A0;or&#x00A0;HP&#x00A0;OpenVMS
&#x00A0;<br />8.2&#x00A0;-&#x00A0;8.3&#x00A0;(85%),&#x00A0;HP&#x00A0;OpenVMS&#x00A0;8.3&#x00A0;(85%),&#x00A0;HP&#x00A0;OpenVMS&#x00A0;7.3&#x00A0;(85%),&#x00A0;HP&#x00A0;OpenVMS&#x00A0;7.2-1&#x00A0;(85%)
&#x00A0;<br />No&#x00A0;exact&#x00A0;OS&#x00A0;matches&#x00A0;for&#x00A0;host&#x00A0;(test&#x00A0;conditions&#x00A0;non-ideal).
&#x00A0;<br />Network&#x00A0;Distance:&#x00A0;1&#x00A0;hop
&#x00A0;<br />
&#x00A0;<br />OS&#x00A0;detection&#x00A0;performed.&#x00A0;Please&#x00A0;report&#x00A0;any&#x00A0;incorrect&#x00A0;results&#x00A0;at
&#x00A0;<br />http://nmap.org/submit/&#x00A0;.
&#x00A0;<br />Nmap&#x00A0;done:&#x00A0;1&#x00A0;IP&#x00A0;address&#x00A0;(1&#x00A0;host&#x00A0;up)&#x00A0;scanned&#x00A0;in&#x00A0;41.67&#x00A0;seconds
&#x00A0;<br />real 0m&#x00A0;43.74s
&#x00A0;<br />user 0m&#x00A0;19.50s
&#x00A0;<br />sys 0m&#x00A0;5.57s
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;
</div>
<!--l. 376--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;6.2: </span><span  
class="content"> <span 
class="ec-lmr-10">Raw output of first Nmap scan of XBox 360, failing to guess target operating</span>
<span 
class="ec-lmr-10">system  </span></span></div><!--tex4ht:label?: x1-200012 -->
                                                                           

                                                                           
<!--l. 383--><p class="indent" >   </div><hr class="endfigure">
<!--l. 385--><p class="indent" >
                                                                           

                                                                           
   <h3 class="sectionHead"><span class="titlemark">6.2   </span> <a 
 id="x1-210006.2"></a>Version scan</h3>
<!--l. 387--><p class="noindent" >By issuing a version scan, this run of Nmap is able to positively identify the service <span 
class="ec-lmri-10x-x-109">XBox</span>
<span 
class="ec-lmri-10x-x-109">360 XML UPnP (Serial number 757502283805) </span>in 13 seconds, as shown in figure <a 
href="#x1-210016.3">6.3<!--tex4ht:ref: fig:nmapxbox --></a>.
<hr class="figure"><div class="figure" 
>
                                                                           

                                                                           
<a 
 id="x1-210013"></a>
                                                                           

                                                                           
<div class="verbatim" id="verbatim-4">
root@Inteno:~#&#x00A0;time&#x00A0;nmap&#x00A0;-sV&#x00A0;-p&#x00A0;1026-1027&#x00A0;192.168.1.218
&#x00A0;<br />
&#x00A0;<br />Starting&#x00A0;Nmap&#x00A0;5.51&#x00A0;(&#x00A0;http://nmap.org&#x00A0;)&#x00A0;at&#x00A0;2013-05-28&#x00A0;18:06&#x00A0;CEST
&#x00A0;<br />Nmap&#x00A0;scan&#x00A0;report&#x00A0;for&#x00A0;192.168.1.218
&#x00A0;<br />Host&#x00A0;is&#x00A0;up&#x00A0;(0.00081s&#x00A0;latency).
&#x00A0;<br />PORT&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;STATE&#x00A0;&#x00A0;&#x00A0;&#x00A0;SERVICE&#x00A0;VERSION
&#x00A0;<br />1026/tcp&#x00A0;open&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;upnp&#x00A0;&#x00A0;&#x00A0;&#x00A0;XBox&#x00A0;360&#x00A0;XML&#x00A0;UPnP&#x00A0;(Serial&#x00A0;number&#x00A0;757502283805)
&#x00A0;<br />1027/tcp&#x00A0;filtered&#x00A0;IIS
&#x00A0;<br />MAC&#x00A0;Address:&#x00A0;00:22:48:40:11:FE&#x00A0;(Microsoft)
&#x00A0;<br />Service&#x00A0;Info:&#x00A0;Device:&#x00A0;game&#x00A0;console
&#x00A0;<br />
&#x00A0;<br />Service&#x00A0;detection&#x00A0;performed.&#x00A0;Please&#x00A0;report&#x00A0;any&#x00A0;incorrect&#x00A0;results&#x00A0;at
&#x00A0;<br />http://nmap.org/submit/&#x00A0;.
&#x00A0;<br />Nmap&#x00A0;done:&#x00A0;1&#x00A0;IP&#x00A0;address&#x00A0;(1&#x00A0;host&#x00A0;up)&#x00A0;scanned&#x00A0;in&#x00A0;12.89&#x00A0;seconds
&#x00A0;<br />real 0m&#x00A0;13.02s
&#x00A0;<br />user 0m&#x00A0;4.09s
&#x00A0;<br />sys 0m&#x00A0;1.44s
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;
</div>
<!--l. 408--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;6.3: </span><span  
class="content"> <span 
class="ec-lmr-10">Raw output of deeper Nmap scan of XBox 360, positively identifying it with</span>
<span 
class="ec-lmri-10">XBox 360 UPnP  </span></span></div><!--tex4ht:label?: x1-210013 -->
                                                                           

                                                                           
<!--l. 415--><p class="indent" >   </div><hr class="endfigure">
                                                                           

                                                                           
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;7</span><br /><a 
 id="x1-220007"></a>Conclusions</h2> The results shows that the system manages to identify the
XBox 360 gaming console, using our extension built into the wrapper. Its services in
terms of ports are well known and defined in the preset part of the implemented system.
The Raspberry Pi running the Debian GNU/Linux distribution is successfully
detected as such, all services selected during the installation are successfully
detected.
<!--l. 427--><p class="noindent" >The preset system will simplify the port forwarding procedure and provide the novice
user with helpful hints, in an otherwise complex graphical environment. Device and
service detection fits with the preset data and the combination of these results results
in a qualified guess, which is presented in the user interface. This part of the
system could be made production ready and included by default in the iopsys
platform.
<!--l. 431--><p class="indent" >   The identification process of the XBox 360 is not a generic Nmap solution, it requires
a workaround implemented in our shell script wrapper. This behaviour is undesirable but
perhaps acceptable, depending on the frequency of the issue. Considering the CPE
operators various needs, we are unable to draw any conclusions as to weather it should be
implemented or not.
<!--l. 435--><p class="indent" >
                                                                           

                                                                           
   <h3 class="sectionHead"><span class="titlemark">7.1   </span> <a 
 id="x1-230007.1"></a>Further development</h3>
<!--l. 438--><p class="noindent" >The solution using Nmap could be interpreted as illegal activity and attempts at
exploiting the systems of a network administrator, this is a risk which could render the
proposed solution undesirable. A fix for this would be to implement a less intrusive
way of identifying services, reviewing the ARP tables which contains the cache
of the address resolution protocol. One could filter possible devices by their
manufacturers MAC address, with an already populated ARP table this procedure is
unintrusive and fast. A more detailed Nmap <span 
class="ec-lmri-10x-x-109">version scan </span>could then be performed
according to a configuration file, mapping MAC addresses to minimal Nmap
commands.
<!--l. 443--><p class="indent" >   The execution time of Nmap is an issue, on local networks with several
devices the latency would be deemed too high. To address this issue one could
adjust the service to preload the automatic identification results and have it run
in the background, to provide a more responsive user experience with cached
results.
<!--l. 446--><p class="indent" >
                                                                           

                                                                           
<!--l. 447--><p class="indent" >
                                                                           

                                                                           
<!--l. 449--><p class="indent" >   <a 
 id="likesection.1"></a><a 
 id="Q1-1-28"></a>
                                                                           

                                                                           
<a 
 id="x1-23001r26"></a>
   <h2 class="appendixHead"><span class="titlemark">Appendix&#x00A0;A</span><br /><a 
 id="x1-24000A"></a>Configuration files</h2>
<!--l. 453--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                           

                                                                           
<a 
 id="x1-240011"></a>
                                                                           

                                                                           
<div class="verbatim" id="verbatim-5">
&#x00A0;&#x00A0;&#x00A0;config&#x00A0;redirect
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;target&#x00A0;&#8217;DNAT&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;src&#x00A0;&#8217;wan&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;dest&#x00A0;&#8217;lan&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;proto&#x00A0;&#8217;tcp&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;src_dport&#x00A0;&#8217;80&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;dest_ip&#x00A0;&#8217;192.168.1.214&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;dest_port&#x00A0;&#8217;80&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;name&#x00A0;&#8217;Web&#x00A0;server&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;
</div>
<!--l. 465--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;A.1: </span><span  
class="content"> <span 
class="ec-lmr-10">Port forwarding section in the UCI </span><span 
class="ec-lmri-10">firewall </span><span 
class="ec-lmr-10">configuration file  </span></span></div><!--tex4ht:label?: x1-240011 -->
                                                                           

                                                                           
<!--l. 472--><p class="noindent" ></div><hr class="endfigure">
<!--l. 474--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                           

                                                                           
<a 
 id="x1-240022"></a>
                                                                           

                                                                           
<div class="verbatim" id="verbatim-6">
&#x00A0;&#x00A0;&#x00A0;config&#x00A0;device&#x00A0;&#8217;xbox360&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;name&#x00A0;&#8217;xbox360&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;description&#x00A0;&#8217;Xbox&#x00A0;360&#x00A0;Live&#8217;
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;config&#x00A0;redirect
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;device&#x00A0;&#8217;xbox360&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;proto&#x00A0;&#8217;udp&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;port&#x00A0;&#8217;88&#8217;
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;config&#x00A0;redirect
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;device&#x00A0;&#8217;xbox360&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;proto&#x00A0;&#8217;tcp&#x00A0;udp&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;port&#x00A0;&#8217;3074&#8217;
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;config&#x00A0;redirect
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;device&#x00A0;&#8217;xbox360&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;proto&#x00A0;&#8217;tcp&#x00A0;udp&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;port&#x00A0;&#8217;53&#8217;
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;config&#x00A0;redirect
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;device&#x00A0;&#8217;xbox360&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;proto&#x00A0;&#8217;tcp&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;option&#x00A0;port&#x00A0;&#8217;80&#8217;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;
</div>
<!--l. 500--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;A.2: </span><span  
class="content"> <span 
class="ec-lmr-10">Preset for port forwarding sections in the UCI </span><span 
class="ec-lmri-10">preset </span><span 
class="ec-lmr-10">configuration file  </span></span></div><!--tex4ht:label?: x1-240022 -->
                                                                           

                                                                           
<!--l. 507--><p class="indent" >   </div><hr class="endfigure">
                                                                           

                                                                           
<!--l. 1--><p class="indent" >
                                                                           

                                                                           
   <h2 class="likechapterHead"><a 
 id="x1-25000A"></a>Bibliography</h2><a 
 id="likesection.2"></a><a 
 id="Q1-1-33"></a>
   <div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 [1]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xinteno_gpl"></a>Inteno  gpl  support  page.     <a 
href="http://www.inteno.se/Support/GPL.aspx" class="url" ><span 
class="ec-lmtt-10x-x-109">http://www.inteno.se/Support/GPL.aspx</span></a>.
   Accessed: 2013-05-21.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [2]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XInteno"></a>New      business      possibilities      with      Open      Source      software.
   <a 
href="http://www.inteno.se/Portals/0/IntenoFiles/ProductDocs/241/689/iopsys_white_paper.pdf_20121015135755.pdf" class="url" ><span 
class="ec-lmtt-10x-x-109">http://www.inteno.se/Portals/0/IntenoFiles/ProductDocs/241/689/iopsys_white_paper.pdf_20121015135755.pdf</span></a>.
   Accessed: 2013-04-29.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [3]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XOpenWrt:structure_design"></a>OpenWrt structure and design. <a 
href="http://wiki.confine-project.eu/_media/soft:openwrt-talk-2012-06-01.pdf" class="url" ><span 
class="ec-lmtt-10x-x-109">http://wiki.confine-project.eu/_media/soft:openwrt-talk-2012-06-01.pdf</span></a>.
   Accessed: 2013-04-29.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [4]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xp0f"></a>p0f   homepage.       <a 
href="http://lcamtuf.coredump.cx/p0f3/" class="url" ><span 
class="ec-lmtt-10x-x-109">http://lcamtuf.coredump.cx/p0f3/</span></a>.       Accessed:
   2013-05-22.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [5]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xportforward.com"></a>Port Forward homepage. <a 
href="http://portforward.com/" class="url" ><span 
class="ec-lmtt-10x-x-109">http://portforward.com/</span></a>. Accessed: 2013-05-14.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [6]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xaretheysecure"></a>Halvar Myrmo.  Game consoles - are they secure?  Master&#8217;s thesis, Gjøvik
   University College.
</p>
   </div>
    
</body></html> 

                                                                           

                                                                           
                                                                           


